<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Notenik | Merge Template File Spec</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Notenik Software">
<meta name="author" content="Herb Bowie">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.png" type="image/png" />
<link rel="stylesheet" href="fonts/concourse_t3.css" type="text/css" />
<link rel="stylesheet" href="fonts/stylesheet.css" type="text/css" />
<link rel="stylesheet" href="css/styles.css" />
</head>
<body>
<div class="container">
<div id="header">
<div id="logo">
<a href="index.html">
<img class="centered" alt="Notenik Logo" src="images/notenik.png" />
</a>
</div>
<div id="title-and-slogan">
<div id="site-title">
Notenik
</div>
<div id="site-slogan">
The Notenik Project
</div>
</div>
</div>

<div id="body">

<h2>Merge Template File Spec</h2>

<p>This specification describes the contents of a template file, used for producing formatted output from a Collection of Notes.</p>
<p>Notenik will look for two sorts of special strings embedded within a template file: variables and commands. These are identified by special delimiters.</p>

<h3>Delimiters</h3>
<p>Notenik will recognize either of two sets of command and variable delimiters automatically. The choice of delimiters will be triggered by the first command-beginning delimiters encountered. The new delimiters are generally recommended, since they are more likely to be treated kindly by various HTML editors when creating your template files.</p>

<table>
<tr><th>Meaning</th><th>Original Delimiters</th><th>New Delimiters</th></tr>
<tr><td>Start of Command</td><td>&lt;&lt;</td><td>&lt;?</td></tr>
<tr><td>End of Command</td><td>&gt;&gt;</td><td>?&gt;</td></tr>
<tr><td>Start of Variable</td><td>&lt;&lt;</td><td>=$</td></tr>
<tr><td>End of Variable</td><td>&gt;&gt;</td><td>$=</td></tr>
<tr><td>Start of Variable Modifiers</td><td>&amp;</td><td>&amp;</td></tr>
</table>

<h3>Variables</h3>
<p>Variables will be replaced by values taken from the corresponding fields of the current Note, or from an internal table of global variables. Variables must be enclosed in the chosen delimiters. Each variable name must match a field label from the data source, or a global name specified in a SET command. The comparison ignores case (upper or lower), embedded spaces and embedded punctuation when looking for a matching field label. So a field label of &quot;First Name&quot; will match with a variable of &quot;firstname&quot;, for example.</p>
<p>A variable, unlike a command, can appear anywhere within the template file, and need not be isolated on a line by itself. More than one variable can appear on the same line. Variables can be used within template commands, as well as other places within the template file.</p>
<p>The following special variables are predefined and available for substitution, no matter what data source is being used.</p>

<dl>
<dt>datafilename</dt>
<dd>The name of the data source being used.</dd>
<dt>dataparent</dt>
<dd>The path to the enclosing folder for the current data file. This can be used as part of an output command to specify an output file in the same folder as the data file.</dd>
<dt>nobr</dt>
<dd>Placing the variable 'nobr' anywhere on a line will cause that line to be written out without a trailing line break. The nobr variable itself will be removed from the line, without being replaced.</dd>
<dt>parentfolder</dt>
<dd>The lowest-level folder immediately enclosing the data file.</dd>
<dt>relative</dt>
<dd>If a Web Root directory has been specified, then this variable will be replaced by the relative path from the output file being created back to the root directory.</dd>
<dt>templatefilename</dt>
<dd>The name of the template file (not including the path to the template file).</dd>
<dt>templateparent</dt>
<dd>The entire parent path to the template file, excluding the file name itself.</dd>
<dt>today</dt>
<dd>The current date, at the time that template output is being generated.</dd>
</dl>

<h3>Variable Modifiers</h3>
<p>A variable can be optionally followed (before the ending variable delimiters) by a modifier indicator and one or more modifiers. The default modifier character is the ampersand (&amp;).</p>
<p>The following list summarizes the primary use of various letters and characters as variable modifiers.</p>

<table>
<tr><td>'</td><td>Email Apostrophes</td></tr>
<tr><td>,</td><td>List Punctuation</td></tr>
<tr><td>1</td><td>Length Modifier</td></tr>
<tr><td>B</td><td>Base File Name</td></tr>
<tr><td>C</td><td>Word Demarcation</td></tr>
<tr><td>F</td><td>File Name</td></tr>
<tr><td>G</td><td>Linked Tags</td></tr>
<tr><td>H</td><td>HTML</td></tr>
<tr><td>I</td><td>Initial Case</td></tr>
<tr><td>J</td><td>Link</td></tr>
<tr><td>K</td><td>Hour of Day</td></tr>
<tr><td>L</td><td>Lowercase Modifier</td></tr>
<tr><td>M</td><td>Month or Minutes</td></tr>
<tr><td>N</td><td>No Breaks</td></tr>
<tr><td>O</td><td>Markdown to HTML</td></tr>
<tr><td>P</td><td>Punctuation Purification</td></tr>
<tr><td>R</td><td>Keep characters on the right</td></tr>
<tr><td>S</td><td>Summarize</td></tr>
<tr><td>U</td><td>Uppercase Modifier</td></tr>
<tr><td>V</td><td>Variance</td></tr>
<tr><td>X</td><td>XML</td></tr>
<tr><td>_</td><td>Underscore</td></tr>
<tr><td>a</td><td>AM/PM</td></tr>
<tr><td>y</td><td>Year</td></tr>
<tr><td>dd</td><td>Day of Month</td></tr>
<tr><td>EEE</td><td>Day of Week, Abbreviated</td></tr>
<tr><td>EEEE</td><td>Day of Week</td></tr>
</table>

<p>Following is a list of the variable modifiers with complete descriptions of how each works.</p>

<h4>Email Apostrophes &quot;'&quot;</h4>
<p>Placing a single apostrophe as part of the variable modifiers string will cause any HTML entities representing an apostrophe to be converted back to a normal ASCII/UTF apostrophe character: '. This can be useful for generating HTML to use as e-mail content, since e-mail parsers seem to sometimes drop the HTML entities commonly used for apostrophes.</p>
<h4>List Punctuation &quot;,&quot;</h4>
<p>Any punctuation character, other than ones specificaly called out in this list for other purposes, will be interpreted as a separator that will be placed before the current variable, if the variable is non-blank, and if the preceding variable was also non-blank and also marked by the same variable modifier. A space will be added after the separator, and before the current variable, if the punctuation is not a forwards or backwards slash (&quot;/&quot; or &quot;\&quot;). This is an easy way to list several variables on a single line, separating non-blank ones from others with commas (or other punctuation).</p>
<h4>Length Modifier &quot;1&quot;</h4>
<p>One or more consecutive digits within the modifiers will be interpreted as the length to which the variable should be truncated or padded. If the length modifier is shorter than the variable length, then by default characters will be truncated on the right (and preserved on the left) of the variable to bring it to the specified length. If it is desired to keep characters on the right, then also use the &quot;R&quot; modifier and place it before the length modifier digits. If the length modifier is longer than the initial variable length, then the variable will be padded with zeroes on the left to bring it to the specified length.</p>
<h4>Base File Name &quot;B&quot;</h4>
<p>The letter &quot;B&quot; will cause the file extension, including the period, to be removed from a file name. This can be used, for example, to generate an output file name with the same name as the input data file (using the variable name &quot;datafilename&quot;), but with a different extension.</p>
<h4>Word Demarcation &quot;C&quot;</h4>
<p>The letter &quot;C&quot; indicates that the variable consists of a series of words, and you wish to change or standardize the way in which the words are distinguished from one another.
When parsing the variable, the beginning of a new word will be indicated by either whitespace or punctuation between words, or by a transition from lowercase to uppercase (as in CamelCase usage). In other words, &quot;two words&quot;, &quot;TWO_WORDS&quot; or &quot;twoWords&quot; would all be parsed into two separate words.</p>
<p>What you want done with the word demarcation is defined by the characters following the &quot;C&quot; in the modifiers string. The letter &quot;u&quot; indicates a conversion to uppercase, the letter &quot;l&quot; indicates a conversion to lowercase, and the letter &quot;a&quot; indicates that the character should be left as-is. Anything other than these three characters (including a space) will be interpreted as a separator to be placed between the words.</p>
<p>Note that the u/l/a indicator can be specified three different times.</p>
<ol>
<li>The first appearance will control the case of the first letter in the entire variable;</li>
<li>The second appearance will control the case of the first letter of each word;</li>
<li>The third appearance will control the appearance of all other letters.</li>
</ol>
<p>For example, if the template file contained the following:</p>
<pre><code>=$name&amp;cuul$=
</code></pre>
<p>And the name variable was equal to:</p>
<pre><code>HERB BOWIE
</code></pre>
<p>Then the resulting name in the output text file would be:</p>
<pre><code>Herb Bowie
</code></pre>
<h4>File Name &quot;F&quot;</h4>
<p>Converts a string to a conventional, universal file name, changing spaces to dashes, removing any odd characters, making all letters lower-case, and converting white space to hyphens.</p>
<h4>Linked Tags &quot;G&quot;</h4>
<p>Each tag found in the variable will be made into a link, linking to '=$relative$=yypathyy/xxtagxx.html', where 'xxtagxx' is the tag, and 'yypathyy' is the string of characters following the 'g'.</p>
<h4>HTML &quot;H&quot;</h4>
<p>The letter &quot;H&quot; will cause selected special characters to be translated to their equivalent HTML entities.</p>
<h4>Initial Case &quot;I&quot;</h4>
<p>When the letter 'I' immediately follows an 'L' or a 'U', then the case transformation (lower or upper) will only be applied to the initial letter of the variable.</p>
<h4>Link &quot;J&quot;</h4>
<p>Convert a URL to an HTML anchor tag with that URL as the href value.</p>
<h4>Hour of Day &quot;K&quot;</h4>
<p>Two lowercase 'k's will represent a 2-digit hour of the day on a 12-hour clock, within a date formatting string.
Two uppercase 'K's will represente a 2-digit hour on a 24-hour clock.</p>
<h4>Lowercase Modifier &quot;L&quot;</h4>
<p>Converts the letters of the variable to lowercase. If immediately followed by 'I', then only the initial letter of the variable will be changed to lowercase.</p>
<h4>Month or Minutes &quot;M&quot;</h4>
<p>Used in a date formatting string, with the following effects:</p>
<ul>
<li>MM - Two-digit month</li>
<li>MMM - Three-letter month abbreviation</li>
<li>MMMM - Full month name</li>
<li>mm - Two-digit minute within the hour</li>
</ul>
<h4>No Breaks &quot;N&quot;</h4>
<p>Remove HTML break (br) tags from the string.</p>
<h4>Markdown to HTML &quot;O&quot;</h4>
<p>The letter &quot;O&quot; will cause the field to be treated as Markdown, and converted to HTML.</p>
<h4>Punctuation Purification &quot;P&quot;</h4>
<p>Remove awkward punctuation characters.</p>
<h4>Keep characters on the right &quot;R&quot;</h4>
<p>The letter &quot;R&quot;, in combination with a length modifier, will cause the variable to be truncated to the given length, truncating characters on the left and keeping characters on the right.</p>
<h4>Summarize &quot;S&quot;</h4>
<p>The letter &quot;S&quot; will pull the first few sentences from the field, within the first 250 characters.</p>
<h4>Uppercase Modifier &quot;U&quot;</h4>
<p>Converts the letters of the variable to uppercase (capital letters). If immediately followed by 'I', then only the initial letter of the variable will be changed to uppercase.</p>
<h4>Variance &quot;V&quot;</h4>
<p>The first character following the 'v' will be used as a delimiter. Everything between the delimiters will be used as a from field. Everything following the second delimiter will be used as a to field. All output lines will be scanned for occurrences of the from field, and will be replaced with the to field.</p>
<h4>XML &quot;X&quot;</h4>
<p>The letter &quot;X&quot; will cause selected special characters to be translated to their equivalent XML entities. This is recommended, for example, when publishing an RSS (Really Simple Syndication) feed.</p>
<h4>Underscore &quot;_&quot;</h4>
<p>An underscore character (&quot;_&quot;) will cause all spaces in the variable to be replaced by underscores. This can be useful when creating a file name, for example. Leading and trailing spaces will be trimmed without replacement.</p>
<h4>AM/PM &quot;a&quot;</h4>
<p>Represents an AM/PM indicator within a date formatting string.</p>
<h4>Year &quot;y&quot;</h4>
<p>Used within a formatting string, with the following effects:</p>
<ul>
<li>yy - Two-digit year</li>
<li>yyyy - Four-digit year</li>
</ul>
<h4>Day of Month &quot;dd&quot;</h4>
<p>Represents a two-digit day of month within a date formatting string.</p>
<h4>Day of Week, Abbreviated &quot;EEE&quot;</h4>
<p>Represents an abbreviated, 3-character, day of week within a date formatting string.</p>
<h4>Day of Week &quot;EEEE&quot;</h4>
<p>Represents a full day of week within a date formatting string.</p>

<h3>Formatting String</h3>
<p>A string of characters indicating how the variable is to be formatted. The formatting string, if specified, should follow any other variable modifiers. Any character other than the modifiers listed above will cause the remainder of the variable modifiers to be treated as a formatting string. Currently, a formatting string is valid only for dates -- either for the special variable <strong>today</strong>, or for any variable date in &quot;mm/dd/yy&quot; format.</p>
<p>A date formatting string follows the normal rules for Java date formatting. One or more occurrences of an upper-case &quot;M&quot; indicates a month, a lower-case &quot;y&quot; is used for a year, and a lower-case &quot;d&quot; is used for the day of the month. An upper-case &quot;E&quot; can be used for the day of the week. Generally, the number of occurrences of each letter you specify will be used to indicate the width of the field you want (&quot;yyyy&quot; for a 4-digit year, for example). Specifying more than two occurrences of &quot;M&quot; indicates you want the month represented by letters rather than numbers, with 4 or more occurrences indicating you want the month spelled out, and 3 occurrences indicating you want a three-letter abbreviation.</p>
<p>See below for full definition of allowable characters and their meanings.</p>

<table>
<tr>
<th>Symbol</th>
<th>Meaning</th>
<th>Presentation</th>
<th>Example</th>
</tr>
<tr>
<td>G</td>
<td>era designator</td>
<td>Text</td>
<td>AD</td>
</tr>
<tr>
<td>y</td>
<td>year</td>
<td>Number</td>
<td>1996</td>
</tr>
<tr>
<td>M</td>
<td>month in year</td>
<td>Text &amp; Number</td>
<td>July &amp; 07</td>
</tr>
<tr>
<td>d</td>
<td>day in month</td>
<td>Number</td>
<td>10</td>
</tr>
<tr>
<td>h</td>
<td>hour in am/pm</td>
<td>1~12</td>
<td>12</td>
</tr>
<tr>
<td>H</td>
<td>hour in day</td>
<td>0~23</td>
<td>0</td>
</tr>
<tr>
<td>m</td>
<td>minute in hour</td>
<td>Number</td>
<td>30</td>
</tr>
<tr>
<td>s</td>
<td>second in minute</td>
<td>Number</td>
<td>55</td>
</tr>
<tr>
<td>S</td>
<td>millisecond</td>
<td>Number</td>
<td>978</td>
</tr>
<tr>
<td>E</td>
<td>day in week</td>
<td>Text</td>
<td>Tuesday</td>
</tr>
<tr>
<td>D</td>
<td>day in year</td>
<td>Number</td>
<td>189</td>
</tr>
<tr>
<td>F</td>
<td>day of week in month</td>
<td>Number</td>
<td>2 (2nd Wed in July)</td>
</tr>
<tr>
<td>w</td>
<td>week in year</td>
<td>Number</td>
<td>27</td>
</tr>
<tr>
<td>W</td>
<td>week in month</td>
<td>Number</td>
<td>2</td>
</tr>
<tr>
<td>a</td>
<td>am/pm marker</td>
<td>Text</td>
<td>PM</td>
</tr>
<tr>
<td>k</td>
<td>hour in day</td>
<td>Number</td>
<td>24</td>
</tr>
<tr>
<td>K</td>
<td>hour in am/pm</td>
<td>Number</td>
<td>0</td>
</tr>
<tr>
<td>z</td>
<td>time zone</td>
<td>Text</td>
<td>Pacific Standard Time</td>
</tr>
<tr>
<td>'</td>
<td>escape for text</td>
<td>Delimiter</td>
<td></td>
</tr>
<tr>
<td></td>
<td>single quote</td>
<td>Literal</td>
<td></td>
</tr>
</table>

<p>The count of pattern letters determine the format.</p>
<p><!-- raw HTML omitted -->(Text)<!-- raw HTML omitted -->: 4 or more pattern letters--use full form,
&lt; 4--use short or abbreviated form if one exists.</p>
<p><!-- raw HTML omitted -->(Number)<!-- raw HTML omitted -->: the minimum number of digits. Shorter
numbers are zero-padded to this amount. Year is handled specially;
that is, if the count of 'y' is 2, the Year will be truncated to 2 digits.</p>
<p><!-- raw HTML omitted -->(Text &amp; Number)<!-- raw HTML omitted -->: 3 or over, use text, otherwise use number.</p>
<p>Any characters in the pattern that are not in the ranges of ['a'..'z']
and ['A'..'Z'] will be treated as quoted text. For instance, characters
like ':', '.', ' ', '#' and '@' will appear in the resulting time text
even they are not embraced within single quotes.</p>

<h3>Commands</h3>
<p>All commands must be enclosed in the chosen delimiters. In addition, all commands must appear on lines by themselves. Command names can be in upper- or lower-case. Each command may have zero or more operands. Operands may be separated by any of the following delimiters: space, comma (','), semi-colon (';') or colon (':'). Operands that contain any of these delimiters must be enclosed in single or double-quotation marks.</p>
<p>The following commands are recognized. They are presented in the typical sequence in which they would be used.</p>

<div class="pnobr">
<p>&lt;?delims new delimiters?&gt;</p>
<p>&lt;?output "filename.ext"?&gt;</p>
<p>&lt;?set global = 0?&gt;</p>
<p>&lt;?nextrec?&gt;</p>
<p>&lt;?include "filename.ext" ?&gt;</p>
<p>&lt;?ifchange ?&gt;</p>
<p>&lt;?if ?&gt;</p>
<p>&lt;?definegroup group-number ?&gt;</p>
<p>&lt;?ifendgroup group-number?&gt;</p>
<p>&lt;?ifendlist group-number?&gt;</p>
<p>&lt;?ifnewlist group-number?&gt;</p>
<p>&lt;?ifnewgroup group-number?&gt;</p>
<p>&lt;?else?&gt;</p>
<p>&lt;?endif?&gt;</p>
<p>&lt;?loop?&gt;</p>
</div>

<h3>delims Command</h3>
<p>If used at all, this command should be the first command in the template file. This command overrides the standard delimiters used to recognize the beginnings and ends of commands and variables, for the remainder of the current template file. The command can have one to five operands. Each operand will become a new delimiter. They should be specified in the following order.</p>
<ul>
<li>beginning of a command (normally paired less than signs)</li>
<li>the end of a command (normally paired greater than signs)</li>
<li>the beginning of a variable (normally paired less than signs)</li>
<li>the end of a variable (normally paired greater than signs)</li>
<li>the beginning of variable modifiers (normally a single ampersand)</li>
</ul>
<p>Note that, in addition to specification of the delims command, the first characters found on the first line of the template file can trigger the Notenik template processor to use an alternate set of delimiters.</p>
<h3>set Command</h3>
<p>This command can define a global variable and set its value. This command would normally have three operands: the name of the global variable, an operator, and a value.</p>
<ul>
<li>
<p>Global variable name. This should not be the same as the name of any variable name specified by the input data file. The global variable name, when used as the object of a set command, should not be enclosed within the normal variable delimiters, since this would cause the variable name to be replaced by its current value.</p>
</li>
<li>
<p>Operator. Any of the following operators can be used.</p>
<ul>
<li>
<p>=  — This will cause the global variable to be set equal to the following value.</p>
</li>
<li>
<p>+= or simply + — This will cause the value to be added to the current value of the global variable.</p>
</li>
<li>
<p>++ — This can be used to add a value of 1 to the current value of the global variable, without having to specify the following value of 1. (In this case, the set command only takes two operands.)</p>
</li>
<li>
<p>-= or simply - — This will cause the value to be subtracted from the current value of the global variable.</p>
</li>
<li>
<p>— Two minus signs in a row can be used to subtract a value of 1 from the current value of the global variable, without having to specify the following value of 1. (In this case, the set command only requires two operands.)</p>
</li>
</ul>
</li>
<li>
<p>Value. This can be a literal or a variable (in which case it should be surrounded by the normal variable delimiters). The value can be a text string or an integer.</p>
</li>
</ul>
<p>One intended use for the set command is to support a line counter. By initializing the value to 0, and then adding to it whenever an output line is generated, the IF command can be used to check for page overflow (in a table column, for example), and then start a new page or column, resetting the counter to 0 again.</p>
<p>Another common use for the set command is to preserve record variables in global variables so that they will be available within an ifendgroup block.</p>
<h3>output Command</h3>
<p>This command names and opens the output file, where the results of the template merge will be stored. The single operand is the name of the output file. This command would normally be the first line in your template file. Subsequent template records will be written to the output file.
Note, however, that the filename can contain a variable name. In this case, the output command would follow the nextrec command, and a new output file would be opened for each row input.</p>
<h3>nextrec Command</h3>
<p>This command indicates the beginning of the code that will be processed/written out once per data row. Lines prior to the nextrec command will only be processed/written out once.</p>
<h3>if Command</h3>
<p>The if command can be used to test a variable to see if it is non-blank. If the variable is non-blank, then the following lines up to the closing endif command will be subject to normal output processing. If the variable is blank, then following lines will be skipped until the closing endif command is encountered. In this case, the first and only operand would be the variable to be tested.</p>
<p>The if command can also be used to test a variable to compare it to a constant (or other variable). In this case, the command would have three or more operands: the name of the variable, a logical operator, and one or more values.</p>
<p>In this second scenario, three operands are provided: the first value (variable or constant), a comparison operator, and the second value (variable or constant).</p>
<p>Any of the following comparisons may be performed, and each may be invoked with the appropriate symbols, abbreviation or words. Note that slashes are used in the following list to separate alternative representations for each operator.</p>
<ol>
<li>= / == / eq / equals</li>
<li>&gt; / gt / greater than</li>
<li>&gt;= / !&lt; | / ge / greater than or equal to</li>
<li>&lt; / lt / less than</li>
<li>&lt;= / !&gt; / le / less than or equal to</li>
<li>&lt;&gt; / != / ne / not equal to</li>
<li>() / [] / co / contains</li>
<li>!() / ![] / nc / does not contain</li>
<li>(&lt;) / [&lt;] / st / starts with</li>
<li>!(&lt;) / ![&lt;] / ns / does not start with</li>
<li>(&gt;) / [&gt;] / fi / ends with</li>
<li>!(&gt;) / ![&gt;] / ng / does not end with</li>
</ol>
<p>Note that, if both values appear to be integers, then a numeric comparison will be performed for operands 1 - 6. In all other cases, strings will be compared.</p>
<h3>else Command</h3>
<p>The else command terminates the scope of its preceding if, ifchange, ifendgroup or ifnewgroup command, and applies the opposite logical condition to the following template lines.</p>
<h3>endif Command</h3>
<p>The endif command terminates the scope of its corresponding if, ifchange, ifendgroup or ifnewgroup command.</p>
<h3>loop Command</h3>
<p>This command indicates the end of the code that will be processed/written out once per data row. Lines after the loop command will be processed/written out once per execution.</p>


</div>
</div>
</body>
</html>
